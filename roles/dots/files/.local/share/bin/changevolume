#!/bin/bash

APP_NAME="changevolume"
URGENCY="low"
REPLACE_ID="9993"
TIMEOUT="2000"

function send_notification() {
	volume=$(pactl get-sink-volume @DEFAULT_SINK@ | awk '{print $5}')
	dunstify \
		--appname="${APP_NAME}" \
		--urgency="${URGENCY}" \
		--replace="${REPLACE_ID}" \
		--hints=int:value:"${volume%\%}" \
		--timeout="${TIMEOUT}" \
		--icon "volume-$1" \
		"Volume: ${volume}" 
}

case $1 in
up)
	pactl set-sink-mute @DEFAULT_SINK@ 0
	pactl set-sink-volume @DEFAULT_SINK@ +10%
	send_notification $1
	;;
max)
	pactl set-sink-mute @DEFAULT_SINK@ 0
	pactl set-sink-volume @DEFAULT_SINK@ 100%
	send_notification $1
	;;
down)
	pactl set-sink-volume @DEFAULT_SINK@ -10%
	send_notification $1
	;;
min)
	pactl set-sink-volume @DEFAULT_SINK@ 0%
	send_notification $1
	;;
mute)
	pactl set-sink-mute @DEFAULT_SINK@ toggle
	muted=$(pactl get-sink-mute @DEFAULT_SINK@ | awk '{print $2}')
	if [ "${muted}" == "yes" ]; then
		dunstify \
			--appname="${APP_NAME}" \
			--urgency="${URGENCY}" \
			--replace="${REPLACE_ID}" \
			--timeout="${TIMEOUT}" \
			--icon "volume-mute" \
			"Volume: Muted" 
	else
		send_notification up
	fi
	;;
micmute)
	pactl set-source-mute @DEFAULT_SOURCE@ toggle
	muted=$(pactl get-source-mute @DEFAULT_SOURCE@ | awk '{print $2}')
	if [ "${muted}" == "yes" ]; then
		dunstify \
			--appname="${APP_NAME}" \
			--urgency="${URGENCY}" \
			--replace="${REPLACE_ID}" \
			--timeout="${TIMEOUT}" \
			--icon "mic-mute" \
			"Mic: Disabled" 
	else
		dunstify \
			--appname="${APP_NAME}" \
			--urgency="${URGENCY}" \
			--replace="${REPLACE_ID}" \
			--timeout="${TIMEOUT}" \
			--icon "mic-mute" \
			"Mic: Enabled" 
	fi
	;;
esac
